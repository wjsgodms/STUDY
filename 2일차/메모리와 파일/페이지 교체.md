--- 

# 페이지 교체 ✨

---

### 요구 페이징

CPU가 특정 페이지에 접근하는 명령어를 실행했을 때, 해당 페이지가 스왑 영역에 있어서 당장 실행시킬 수 없는 상태일 경우에는 '페이지 폴트' 라는 예외가 발생한다.


페이지 폴트가 예외가 발생하면 스와핑 작업이 먼저 진행된 후에 프로세스가 실행된다.

실행할 모든 프로세스를 메모리에 올려두는 것은 시스템에 부담이 될 수 있는 만큼 당장 필요한 페이지만을 메모리에 우선 적재하는 방법을 가리켜 '요구 페이징'이라 한다.

### 페이징 교체 정책

메인 메모리가 꽉 차있는 상태에서 스와프 영역에 있는 메모리를 메인 메모리로 이동시켜야 하는 경우가 있다. 이 때 메인 메모리의 빈 공간을 만들어주기 위해 메인 메모리에 들어차있는 페이지 중 어떤 페이지를 스와프 영역으로 보낼지 결정하고 또 그것을 처리하는 작업을 **페이지 교체**라고 한다.

---

## 페이지 교체 정책 방식 

1. 선입선출
    - 메모리에 들어온 시간이 가잗 오래된 페이지를 교체하는 방식이다.
    - 단순한 규칙인 만큼 구현 방법도 간단한 편이다.

2. 최적 페이지 교체
    - 자주 사용될 예정인 페이지를 내버려두고 사용이 거의 없는 페이지를 교체하는 방식이다.
    - 페이지 볼트가 아주 적게 발생하는 최적의 방법이다.
    - 어떤 프로세스가 더 많이 사용될지 아는 것은 불가능하기 때문에 이론적으로만 존재하고 실제로 구현하기엔 어렵다.

3. LRU
    - 최근 사용 빈도가 가장 적은 페이지를 교체하는 방식이다.


---

## 스래싱

이 모든 것의 근본적인 이유는 메모리 공간의 부족, 즉 프레임 부족이다.

프레임이 부족하면 페이지 폴트가 자주 발생한다.
페이지 폴트가 발생하면 잦은 스와핑 작업으로 인해 CPU 사용률이 떨어지게 된다.

CPU 사용룰이 떨어지면 운영체제는 더 많은 프로세스를 메모리에 올리려 하고, 이는 더 잦은 페이지 폴트로 이어져 악순환에 빠지게 된다. 

이러한 문제를 '스레싱' 이라고 한다.

스래싱에 대한 소프트웨어적인 해결책으로, '워킹셋' 이라는 것을 활용하는 방법을 예로 들 수 있다. 

## 워킹셋이란?

프로세스는 일정 시간 동안 특정 주소를 참조하는 경향이 있다.

이러한 참조 페이지들을 동시에 메모리에 올려야 하는 페이지들의 집합을 워킹셋이라고 한다.

